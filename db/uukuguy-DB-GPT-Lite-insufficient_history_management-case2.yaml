app: DB-GPT-Lite
repo: https://github.com/uukuguy/DB-GPT-Lite
commit: d857cb71f2c19e8535d0f5e9692e15c4e4dd100d
defect_id: uukuguy-DB-GPT-Lite-insufficient_history_management-case2
type: insufficient history management
case: '2'
consequence:
- IC
locations:
- 1.dbgpt/app/scene/chat_knowledge/v1/chat.py
- 2.dbgpt/rag/retriever/embedding.py
- 3.dbgpt/app/scene/chat_knowledge/v1/prompt.py
trigger_tests:
- '1.Enter the Chat Knowledge scenario.

  2.Upload a .pdf knowledge file (e.g., "The Little Prince") to the knowledge base.

  3.Ask the question: "What is special about the Little Prince''s rose?"

  4.System responds with correct information about the rose.

  5.Ask the llm: "What question did I just ask?" The model answers: "What is the role
  of a rose''s thorns?"

  Expected Result:

  System should correctly recall: "Your previous question was: ''What is special about
  the Little Prince''s rose?''"

  Actual Result:

  System responds: "Your previous question was: ''What is the role of a rose''s thorns?''"'
